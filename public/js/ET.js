"use strict";function _instanceof(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function _createForOfIteratorHelper(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var s=0,a=function(){};return{s:a,n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o=!0,i=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){i=!0,n=t},f:function(){try{o||null==r.return||r.return()}finally{if(i)throw n}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=t[r];return s}function _classCallCheck(t,e){if(!_instanceof(t,e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var ETAudioPlayer=function(){function t(){var e=this;_classCallCheck(this,t),_defineProperty(this,"mouseDown",function(){e.moving=!0,document.addEventListener("mousemove",e.moveplayhead,!0),e.audio.removeEventListener("timeupdate",e.timeUpdate,!1)}),_defineProperty(this,"moveplayhead",function(t){var r=(t.clientX-e.DesktopProgressBarTrack.getBoundingClientRect().left)/e.DesktopProgressBarTrack.offsetWidth*100,s=r-100;return r>100?(e.DesktopProgressBarButton.style.left="".concat(100,"%"),void(e.DesktopProgressBar.style.transform="translateX(".concat(0,"%)"))):r<0?(e.DesktopProgressBarButton.style.left="".concat(0,"%"),void(e.DesktopProgressBar.style.transform="translateX(".concat(-100,"%)"))):(e.DesktopProgressBarButton.style.left="".concat(r,"%"),void(e.DesktopProgressBar.style.transform="translateX(".concat(s,"%)")))}),_defineProperty(this,"mouseUp",function(t){if(e.moving){e.moveplayhead(t),document.removeEventListener("mousemove",e.moveplayhead,!0);var r=e.DesktopProgressBarButton.style.left,s=r.substring(0,r.length-1);s/=100;var a=e.currentSong.duration*s;a=a.toFixed(0),a/=1e3,e.audio.currentTime=a,e.audio.addEventListener("timeupdate",e.timeUpdate,!1)}e.moving=!1}),_defineProperty(this,"touchplayhead",function(t){var r;e.audio.removeEventListener("timeupdate",e.timeUpdate,!1),t.touches[0].clientX&&(r=t.touches[0].clientX-e.progressBarTrack.getBoundingClientRect().left),t.clientX&&(r=t.clientX-e.progressBarTrack.getBoundingClientRect().left);var s=r/e.progressBarTrack.offsetWidth*100,a=s-100;return s>100?(e.progressBarButton.style.left="".concat(100,"%"),e.progressBar.style.transform="translateX(".concat(0,"%)"),void(e.miniProgressBar.style.transform="translateX(".concat(0,"%)"))):s<0?(e.progressBarButton.style.left="".concat(0,"%"),e.progressBar.style.transform="translateX(".concat(-100,"%)"),void(e.miniProgressBar.style.transform="translateX(".concat(-100,"%)"))):(e.progressBarButton.style.left="".concat(s,"%"),e.progressBar.style.transform="translateX(".concat(a,"%)"),void(e.miniProgressBar.style.transform="translateX(".concat(a,"%)")))}),_defineProperty(this,"timeUpdate",function(){var t=e.audio.currentTime/e.currentSong.duration*1e5,r=t-100;e.progressBarButton.style.left="".concat(t,"%"),e.progressBar.style.transform="translateX(".concat(r,"%)"),e.DesktopProgressBarButton.style.left="".concat(t,"%"),e.DesktopProgressBar.style.transform="translateX(".concat(r,"%)"),e.miniProgressBar.style.transform="translateX(".concat(r,"%)")}),_defineProperty(this,"endTouch",function(){var t=e.progressBarButton.style.left,r=t.substring(0,t.length-1);r/=100;var s=e.currentSong.duration*r;s=s.toFixed(0),s/=1e3,e.audio.currentTime=s,e.audio.addEventListener("timeupdate",e.timeUpdate,!1)}),this.playlist=[],this.fullMobilePlayerShow=!1,this.fullMobileList=!1,this.currentSong={},this.previousSongId=-1,this.playing=!1,this.loading=!1,this.moving=!1,this.audio=document.getElementById("audio-ele"),this.playerTitle=document.getElementsByClassName("player-title"),this.playerSinger=document.getElementsByClassName("player-singer"),this.playerCover=document.getElementsByClassName("fmp-img"),this.fullPlayer=document.getElementById("fmp"),this.fullPlaylistPanel=document.getElementById("fml"),this.progressBarTrack=document.getElementById("progress-bar__track"),this.progressBar=document.getElementById("progress-bar__progress"),this.progressBarButton=document.getElementById("progress-bar__button"),this.DesktopProgressBarTrack=document.getElementById("desktop-player__progress-bar_track"),this.DesktopProgressBar=document.getElementById("desktop-player__progress-bar_progress"),this.DesktopProgressBarButton=document.getElementById("desktop-player__progress-bar_button"),this.playButtons=document.getElementsByClassName("play-icon"),this.miniPlayer=document.getElementById("smp"),this.miniProgressBarTrack=document.getElementById("mini-progress-bar__track"),this.miniProgressBar=document.getElementById("mini-progress-bar__progress"),this.initializeSC(),this.loadPlaylistFromSC(),this.initProgressBars(),this.setEventListeners()}return _createClass(t,[{key:"initializeSC",value:function(){SC.initialize({client_id:"qar87rq7vEGGfgjM0PqrmTBUYhSzUcQ5",redirect_uri:"https://example.com/callback"})}},{key:"loadPlaylistFromSC",value:function(){var t=this;SC.get("playlists/1064225653").then(function(e){e.tracks.forEach(function(e,r){t.playlist.push({id:r,title:e.title,singer:"",cover:e.artwork_url.replace("large","t500x500"),musicSrc:"".concat(e.stream_url,"?client_id=qar87rq7vEGGfgjM0PqrmTBUYhSzUcQ5"),duration:e.duration})}),t.initPlayer()})}},{key:"initPlayer",value:function(){this.updatePlayer(this.playlist[0]),this.updatePlaylistPanel(),this.updatePanel()}},{key:"initProgressBars",value:function(){this.progressBar.style.transform="translateX(".concat(-100,"%)"),this.miniProgressBar.style.transform="translateX(".concat(-100,"%)"),this.DesktopProgressBar.style.transform="translateX(".concat(-100,"%)")}},{key:"setEventListeners",value:function(){var t=this;this.audio.addEventListener("timeupdate",this.timeUpdate,!1),this.audio.addEventListener("ended",this.next),this.progressBarButton.addEventListener("touchstart",function(e){return t.touchplayhead(e)},{passive:!0}),this.progressBarButton.addEventListener("touchmove",function(e){return t.touchplayhead(e)},{passive:!0}),this.progressBarButton.addEventListener("touchend",function(e){return t.endTouch(e)}),this.progressBarTrack.addEventListener("touchstart",function(e){return t.touchplayhead(e)},{passive:!0}),this.progressBarTrack.addEventListener("touchmove",function(e){return t.touchplayhead(e)},{passive:!0}),this.progressBarTrack.addEventListener("touchend",function(e){return t.endTouch(e)}),this.DesktopProgressBarTrack.addEventListener("mousedown",this.mouseDown),this.DesktopProgressBarTrack.addEventListener("mouseup",function(e){return t.mouseUp(e)}),this.DesktopProgressBarButton.addEventListener("mousedown",this.mouseDown),document.addEventListener("mouseup",this.mouseUp)}},{key:"play",value:function(){this.playing?(this.playing=!1,this.audio.pause(),this.showPlay()):(this.playing=!0,this.audio.play(),this.showPause(),this.updatePanel())}},{key:"updatePanel",value:function(){if(this.currentSong.id!==this.previousSongId){var t=document.getElementById(this.currentSong.id);t.style.fontWeight="bold",t.style.color="#05aea5";var e=document.getElementById(this.previousSongId);e&&(e.style.fontWeight="normal",e.style.color="black")}}},{key:"updatePlayer",value:function(t){this.audio.src=t.musicSrc;var e,r=_createForOfIteratorHelper(this.playerTitle);try{for(r.s();!(e=r.n()).done;){e.value.innerHTML=t.title}}catch(t){r.e(t)}finally{r.f()}var s,a=_createForOfIteratorHelper(this.playerSinger);try{for(a.s();!(s=a.n()).done;){s.value.innerHTML=t.singer}}catch(t){a.e(t)}finally{a.f()}var n,o=_createForOfIteratorHelper(this.playerCover);try{for(o.s();!(n=o.n()).done;){n.value.src=t.cover}}catch(t){o.e(t)}finally{o.f()}this.currentSong=t}},{key:"updatePlaylistPanel",value:function(){var t,e,r,s=document.getElementById("mp");for(t=document.getElementsByTagName("template")[0].content.querySelector("div"),r=0;r<this.playlist.length;r++){(e=document.importNode(t,!0)).id=r,e.setAttribute("onclick","ETPlayer.playNow(".concat(this.playlist[r].id,")")),e.querySelector("img").src=this.playlist[r].cover,e.querySelector("p").innerHTML="".concat(this.playlist[r].title),s.appendChild(e)}}},{key:"showPause",value:function(){var t,e=_createForOfIteratorHelper(this.playButtons);try{for(e.s();!(t=e.n()).done;){var r=t.value;r.classList.remove("fa-play"),r.classList.add("fa-pause")}}catch(t){e.e(t)}finally{e.f()}}},{key:"showPlay",value:function(){var t,e=_createForOfIteratorHelper(this.playButtons);try{for(e.s();!(t=e.n()).done;){var r=t.value;r.classList.remove("fa-pause"),r.classList.add("fa-play")}}catch(t){e.e(t)}finally{e.f()}}},{key:"playNow",value:function(t){this.previousSongId=this.currentSong.id,this.updatePlayer(this.playlist[t]),this.updatePanel(),this.showPause(),this.audio.play(),this.playing=!0}},{key:"next",value:function(){this.previousSongId=this.currentSong.id;var t=this.currentSong.id+1;this.playlist.length===t&&(t=0),this.updatePlayer(this.playlist[t]),this.updatePanel(),this.showPause(),this.audio.play(),this.playing=!0}},{key:"prev",value:function(){this.previousSongId=this.currentSong.id;var t=this.currentSong.id-1;t<0&&(t=this.playlist.length-1),this.updatePlayer(this.playlist[t]),this.updatePanel(),this.showPause(),this.audio.play(),this.playing=!0}},{key:"toggleMobileList",value:function(){this.fullMobileList?(history.replaceState(null,"","/index.html#player"),this.fullPlaylistPanel.style.transform="translateY(100vh)",this.fullMobileList=!this.fullMobileList):(history.pushState(null,"","/index.html#playlist"),this.fullPlaylistPanel.style.transform="translateY(0)",this.fullMobileList=!this.fullMobileList)}},{key:"toggleMobilePlayer",value:function(){this.fullMobilePlayerShow?(history.pushState(null,"","/index.html"),this.miniPlayer.style.transitionDelay="350ms",this.miniPlayer.style.transform="translateY(0)",this.fullPlayer.style.transform="translateY(100vh)",this.fullMobilePlayerShow=!this.fullMobilePlayerShow):(history.pushState(null,"","/index.html#player"),this.miniPlayer.style.transitionDelay="0ms",this.miniPlayer.style.transform="translateY(160px)",this.fullPlayer.style.transform="translateY(0)",this.fullMobilePlayerShow=!this.fullMobilePlayerShow)}}]),t}(),ETPlayer=new ETAudioPlayer;window.onload=function(){ETPlayer.miniPlayer.style.transform="translateY(0)"},window.onpopstate=function(){"#player"===window.location.hash&&ETPlayer.toggleMobileList(),""===window.location.hash&&ETPlayer.toggleMobilePlayer()};